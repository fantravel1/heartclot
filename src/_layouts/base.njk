<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{{ description or site.description }}">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#8B0000">
    <link rel="canonical" href="{{ site.url }}{{ page.url }}">

    <!-- Primary Meta Tags -->
    <meta name="title" content="{{ title or site.title }}">
    <meta name="author" content="{{ site.author.name }}">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{{ ogType or 'website' }}">
    <meta property="og:url" content="{{ site.url }}{{ page.url }}">
    <meta property="og:title" content="{{ title or site.title }}">
    <meta property="og:description" content="{{ description or site.description }}">
    <meta property="og:image" content="{{ ogImage or site.social.ogImage }}">
    <meta property="og:site_name" content="{{ site.name }}">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="{{ site.url }}{{ page.url }}">
    <meta property="twitter:title" content="{{ title or site.title }}">
    <meta property="twitter:description" content="{{ description or site.description }}">
    <meta property="twitter:image" content="{{ ogImage or site.social.ogImage }}">

    <!-- Schema.org Structured Data -->
    {% if schema %}
    <script type="application/ld+json">
    {{ schema | dump | safe }}
    </script>
    {% endif %}

    <!-- Breadcrumb Schema (for content pages) -->
    {% if tableOfContents %}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "{{ site.url }}"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "{{ title }}",
          "item": "{{ site.url }}{{ page.url }}"
        }
      ]
    }
    </script>
    {% endif %}

    <!-- FAQ Schema for AEO/Voice Search -->
    {% if faqSchema %}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {% for faq in faqSchema %}
        {
          "@type": "Question",
          "name": "{{ faq.question }}",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "{{ faq.answer }}"
          }
        }{% if not loop.last %},{% endif %}
        {% endfor %}
      ]
    }
    </script>
    {% endif %}

    <title>{{ title or site.title }}</title>

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>❤️</text></svg>">

    <!-- Preconnect to external domains for performance -->
    <link rel="preconnect" href="https://www.youtube-nocookie.com">

    <!-- Stylesheet -->
    <link rel="stylesheet" href="/styles/main.css">

    <!-- Additional head content -->
    {% block extraHead %}{% endblock %}
</head>
<body>
    <!-- Skip to main content link for keyboard navigation -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Header Navigation -->
    <header role="banner">
        <nav role="navigation" aria-label="Main navigation">
            <a href="/" class="logo" aria-label="HeartClot - Home">HeartClot</a>

            <button
                class="mobile-menu-toggle"
                onclick="toggleMenu()"
                aria-label="Toggle navigation menu"
                aria-expanded="false"
                aria-controls="navMenu">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <ul class="nav-links" id="navMenu">
                {% for item in navigation %}
                <li>
                    <a href="{{ item.url }}"
                       {% if page.url == item.url + '/' or page.url == item.url + '/index.html' %}
                       class="active"
                       aria-current="page"
                       {% endif %}
                       title="{{ item.description }}">
                        {{ item.title }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </nav>
    </header>

    <!-- Main Content -->
    <main id="main-content" role="main">
        {% block content %}{% endblock %}
    </main>

    <!-- Reading Progress Indicator (for content pages) -->
    {% if showReadingProgress %}
    <div id="readingProgress"
         role="progressbar"
         aria-label="Reading progress"
         aria-valuemin="0"
         aria-valuemax="100"
         style="position: fixed; top: 70px; left: 0; height: 3px; background: var(--blood-red); width: 0%; z-index: 999; transition: width 0.2s;">
    </div>
    {% endif %}

    <!-- Scroll to Top Button -->
    {% if showScrollToTop %}
    <button
        id="scrollToTop"
        onclick="scrollToTop()"
        aria-label="Scroll to top"
        style="display: none; position: fixed; bottom: 2rem; right: 2rem; background: var(--blood-red); color: white; border: none; border-radius: 50%; width: 50px; height: 50px; font-size: 1.5rem; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 999; transition: all 0.3s;">
        ↑
    </button>
    {% endif %}

    <!-- Footer -->
    <footer role="contentinfo">
        <p>Based on clinical experience of {{ site.author.name }}, {{ site.author.title }} | For emergencies call 911</p>
        <p>Educational content only - not medical advice</p>
        <p>&copy; {{ site.currentYear }} {{ site.name }}. All rights reserved.</p>
    </footer>

    <!-- JavaScript -->
    <script src="/scripts/main.js"></script>

    <!-- Additional scripts -->
    {% block extraScripts %}{% endblock %}
</body>
</html>
